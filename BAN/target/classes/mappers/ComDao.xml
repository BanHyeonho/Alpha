<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com">

	<!--아이디 중복체크 -->
	<select id="idChk" parameterType="hashmap" resultType="hashmap">
		SELECT ID		AS ID
		  FROM MEMBER
		 WHERE USE_YN ='1' 
		   AND ID = #{id,jdbcType=VARCHAR}
	</select>

	<!--개인정보 조회 -->
	<select id="myInfo" parameterType="hashmap" resultType="hashmap">
		SELECT A.ID			AS ID
			 , A.NAME		AS NAME
			 , A.CDT		AS CDT
			 , A.USE_YN		AS USE_YN
			 , B.NICK		AS NICK
			 , B.EMAIL		AS EMAIL
			 , B.TEL		AS TEL
		  FROM MEMBER A
	 LEFT JOIN MEMBER_DETAIL B ON A.MEMBER_ID = B.MEMBER_ID
		 WHERE A.ID = #{LOGIN_ID,jdbcType=VARCHAR}
	</select>
	
	<!--로그인 -->
	<select id="login" parameterType="hashmap" resultType="hashmap">
		SELECT A.ID			AS ID
			 , A.NAME		AS NAME
			 , A.CDT		AS CDT
			 , A.USE_YN		AS USE_YN
			 , B.NICK		AS NICK
			 , B.EMAIL		AS EMAIL
			 , B.TEL		AS TEL
		  FROM MEMBER A
	 LEFT JOIN MEMBER_DETAIL B ON A.MEMBER_ID = B.MEMBER_ID
		 WHERE A.ID = #{id,jdbcType=VARCHAR}
	</select>
		
	<!-- 회원가입 -->
	<insert id="memberInsert" parameterType="hashmap" >
		
		<selectKey order="BEFORE" keyProperty="MID" resultType="int">
			SELECT MEMBER_S.NEXTVAL FROM DUAL
		</selectKey>
		
		INSERT INTO MEMBER(MEMBER_ID, ID, PWD, NAME)
		VALUES(#{MID,jdbcType=INTEGER}, #{id,jdbcType=VARCHAR}, #{pwd,jdbcType=VARCHAR}, #{name,jdbcType=VARCHAR})
		
	</insert>
	
	<!-- 회원가입 상세 -->
	<insert id="memberDetailInsert" parameterType="hashmap" >
		
		<selectKey order="BEFORE" keyProperty="MDID" resultType="int">
			SELECT MEMBER_DETAIL_S.NEXTVAL FROM DUAL
		</selectKey>
		
		INSERT INTO MEMBER_DETAIL(MEMBER_ID, MEMBER_DETAIL_ID, NICK, EMAIL, TEL)
		VALUES(#{MID,jdbcType=INTEGER}, #{MDID,jdbcType=INTEGER}, #{nick,jdbcType=VARCHAR}, #{email,jdbcType=VARCHAR}, #{tel,jdbcType=VARCHAR})
		
	</insert>
	
	<!--페이지이동 -->
	<select id="page" parameterType="hashmap" resultType="hashmap">
		SELECT MENU_URL 	AS MENU_URL
			  ,MENU_NM  	AS MENU_NM
			  ,SECURE_YN  	AS SECURE_YN
			  ,PATH  		AS PATH
		  FROM MENU
		 WHERE USE_YN = '1'
		   AND MENU_URL = #{menuUrl,jdbcType=VARCHAR}
	</select>

	<!-- 화면추가 -->
	<insert id="menuInsert" parameterType="hashmap" >
		
		<selectKey order="BEFORE" keyProperty="id" resultType="int">
			SELECT MENU_S.NEXTVAL FROM DUAL
		</selectKey>
		
		INSERT INTO MENU(MENU_ID,MENU_URL,MENU_NM,DSC)
		VALUES(#{id,jdbcType=INTEGER},#{menu_url,jdbcType=VARCHAR},#{menu_nm,jdbcType=VARCHAR},#{dsc,jdbcType=VARCHAR})
		
	</insert>
	
</mapper>